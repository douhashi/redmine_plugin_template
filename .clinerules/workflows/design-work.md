# 設計作業ワークフロー

このドキュメントは、GitHub Issueを基にした要件定義から実行計画作成までの設計作業プロセスを定義します。

## 概要

設計作業は、GitHub Issueを参照し、要件を定義して「実行計画」でIssueを更新する作業です。PMモードとArchitectモードを適切に使い分けながら、実装開始可能な詳細な計画を作成します。

## GitHub Issueワークフロー

要件はGithubのIssueとして与えられます。プロジェクトの要件管理にはGitHub Issueを使用します：

### 1. 要件定義（PMモード）

#### GitHub Issueの内容確認
```bash
GH_PAGER= gh issue view <issue番号>
```

#### 要件が不明確な場合の質問
```bash
GH_PAGER= gh issue comment <issue番号> --body "要件について質問: ..."
```

#### 主な作業内容
- 要件の詳細化や優先度の確認を行う
- ステークホルダーとの認識合わせ
- 制約条件や前提条件の明確化
- 成功基準の定義

### 2. 設計（Architectモード）

#### 設計内容の追記
- 設計内容をIssueの説明欄に追記する
- 「実装開始可能な実行計画」をIssueの説明に更新する

## 実行計画テンプレート

PMモードとArchitectモードの成果物として、以下の構造に従った「実装開始可能な実行計画」をIssueの説明に更新します：

```bash
# tmp以下に実行計画の内容を記載したファイルを作成しておく
GH_PAGER= gh issue edit <issue番号> --body-file tmp/issue_body.md
```

#### ファイルの内容例（tmp/issue_body.md）：

```markdown
# 実行計画: [タイトル]

## 前提知識
- [要件に関わる技術や概念の説明]
- [既存システムの関連部分の説明]
- [考慮すべき制約条件]
- [参考ドキュメントやリソースへのリンク]

## 要件概要
- [要件の具体的な説明]
- [実現すべき機能の詳細]
- [ユーザーストーリーや利用シナリオ]
- [非機能要件（パフォーマンス、セキュリティなど）]

## 実装計画
1. [具体的な実装ステップ1]
   - [詳細なタスク]
   - [使用するコンポーネントや技術]
   - [予想される課題と対策]

2. [具体的な実装ステップ2]
   - [詳細なタスク]
   - [コード変更の概要]
   - [影響範囲]

3. [具体的な実装ステップ3]
   ...

## テスト計画
1. [ユニットテスト計画]
   - [テスト対象のメソッド/クラス]
   - [テストケース（正常系・異常系）]
   - [モックの使用方針]

2. [システムテスト計画]
   - [テスト対象のユーザーフロー]
   - [テストシナリオ]
   - [テストデータの準備方法]

3. [その他の検証項目]
   - [パフォーマンステスト]
   - [セキュリティテスト]
   - [アクセシビリティテスト]

## リスクと対策
- [予想されるリスク1]
  - [対策]
- [予想されるリスク2]
  - [対策]
...

## タイムライン
- 実装予定期間: [開始日] 〜 [終了日]
- マイルストーン:
  - [日付]: [達成すべき中間目標1]
  - [日付]: [達成すべき中間目標2]
```

## 実行計画作成ワークフロー

### 1. 要件確認（PMモード）

#### 基本情報の収集
- GitHub Issueの内容を確認
- 要件に関する質問や不明点を洗い出し
- 必要に応じて追加情報を収集

#### ステークホルダーとの調整
- 要件の優先度確認
- 制約条件の明確化
- 成功基準の合意形成

### 2. 実行計画ドラフト作成（PMモード）

実行計画テンプレートの「前提知識」と「要件概要」セクションを作成：

```bash
# tmp以下に実行計画ドラフトの内容を記載したファイルを作成しておく
GH_PAGER= gh issue edit <issue番号> --body-file tmp/issue_body_draft.md
```

#### ファイルの内容例（tmp/issue_body_draft.md）：
```markdown
# 実行計画: [タイトル]

## 前提知識
- [要件に関わる前提知識...]

## 要件概要
- [要件の具体的な説明...]
```

#### 主な作業内容
- 要件の詳細化と明確化
- 前提条件の整理
- 参考資料の収集と整理

### 3. 実行計画の完成（Architectモード）

「実装計画」と「テスト計画」セクションを追加し、技術的な詳細を具体化：

```bash
# tmp以下に実行計画の内容を記載したファイルを作成しておく
GH_PAGER= gh issue edit <issue番号> --body-file tmp/implementation_plan.md
```

#### ファイルの内容例（tmp/implementation_plan.md）：
```markdown
# 実行計画: [タイトル]

## 実装計画
1. [具体的な実装ステップ...]

## テスト計画
1. [テスト計画の詳細...]

## リスクと対策
- [予想されるリスク...]

## タイムライン
- 実装予定期間: [...]
```

#### 主な作業内容
- 技術的な詳細と実装手順を具体化
- アーキテクチャ設計の決定
- リスクと対策、タイムラインを設定
- 依存関係の整理

### 4. 実行計画のレビュー

実行計画の完成後、関係者によるレビューを実施：

```bash
# tmp以下にレビューのフィードバックを記載したファイルを作成しておく
GH_PAGER= gh issue comment <issue番号> --body-file tmp/review_feedback.md
```

#### レビューポイント
- 実装可能性の確認
- リソース配分の妥当性
- リスク評価の適切性
- タイムラインの現実性

### 5. 実装開始の承認

実行計画が承認されたら、実装フェーズに移行：

```bash
GH_PAGER= gh issue edit <issue番号> --add-label "ready-for-development"
```

#### 承認後の作業
- 実装チームへの引き継ぎ
- 進捗管理の準備
- 定期レビューのスケジュール設定

## 品質管理

### 実行計画の品質基準

#### 完成度チェックリスト
- [ ] 要件が明確に定義されている
- [ ] 実装手順が具体的で実行可能
- [ ] テスト計画が網羅的
- [ ] リスクが適切に識別・評価されている
- [ ] タイムラインが現実的
- [ ] 依存関係が明確

#### レビュー観点
- **技術的妥当性**: 選択した技術やアーキテクチャが適切か
- **実装可能性**: 現在のリソースと技術レベルで実現可能か
- **保守性**: 長期的な保守・拡張を考慮した設計か
- **パフォーマンス**: 性能要件を満たす設計か

## ベストプラクティス

### 効果的な要件定義
- ユーザーの視点を重視する
- 具体的で測定可能な成功基準を設定
- エッジケースや例外処理を考慮
- 既存システムとの整合性を確認

### 実装計画の作成
- 小さな単位に分割して段階的に実装
- 依存関係を明確にして順序を決定
- 各ステップの完了基準を明確化
- バックアップ計画を用意

### コミュニケーション
- 定期的な進捗共有
- 課題や変更点の早期エスカレーション
- ドキュメントの継続的な更新
- ステークホルダーとの認識合わせ

## トラブルシューティング

### よくある問題と対策

#### 要件が曖昧な場合
- 具体的な質問を用意してステークホルダーに確認
- プロトタイプやモックアップを作成して認識合わせ
- ユーザーストーリーマッピングを実施

#### 技術的な実現可能性が不明な場合
- 技術調査（スパイク）を実施
- プロトタイプを作成して検証
- 専門家への相談やレビュー依頼

#### スケジュールが厳しい場合
- 要件の優先度を再確認
- MVP（最小実行可能製品）の定義
- 段階的リリースの検討

## 関連ドキュメント

- [基本ルール](.clinerules/default.md)
- [学習記録](.clinerules/lessons-learned/)
- [プロジェクトドキュメント](docs/)
